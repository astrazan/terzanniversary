<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Fortune Cookie</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
  body {
    background: #f7efe5;
    font-family: Georgia, serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .scene {
    position: relative;
    width: 320px;
    height: 240px;
  }

  .hint {
    position: absolute;
    top: -34px;
    width: 100%;
    text-align: center;
    font-size: 14px;
    color: #8a6b3f;
  }

  /* ===== COOKIE ===== */
  .cookie {
    position: absolute;
    bottom: 0;
    left: 50%;
    width: 260px;
    height: 160px;
    transform: translateX(-50%);
    z-index: 2;
    pointer-events: none;
    overflow: hidden;
  }

  .cookie-half {
    position: absolute;
    bottom: 0;
    width: 130px;
    height: 160px;
    background: #d2a56d;
    overflow: hidden;
    transition: transform 0.6s ease;
  }

  .cookie-half::before {
    content: "";
    position: absolute;
    top: -20px;
    width: 260px;
    height: 80px;
    background: #e0b27a;
    border-radius: 140px 140px 0 0;
  }

  .cookie-left {
    left: 0;
    border-radius: 0 0 0 140px;
  }

  .cookie-left::before {
    left: 0;
  }

  .cookie-right {
    right: 0;
    border-radius: 0 0 140px 0;
  }

  .cookie-right::before {
    right: 0;
  }

  /* CRACKED STATE */
  .cookie.cracked .cookie-left {
    transform: translateX(-28px) rotate(-8deg);
  }

  .cookie.cracked .cookie-right {
    transform: translateX(28px) rotate(8deg);
  }

  /* ===== FORTUNE STRIP ===== */
  .fortune-wrapper {
    position: absolute;
    bottom: 62px;
    left: 50%;
    transform: translateX(-50%);
    width: 260px;
    height: 60px;
    overflow: visible;
    z-index: 4;
  }

  .fortune {
    position: absolute;
    left: 0;
    top: 0;
    height: 60px;
    width: 420px;
    z-index: 5;
    background: #fffdf7;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    padding: 14px 20px;
    box-sizing: border-box;
    cursor: grab;
    user-select: none;
    transform: translateX(-300px);
    transition: box-shadow 0.2s;
  }

  .fortune:active {
    cursor: grabbing;
    box-shadow: 0 8px 18px rgba(0,0,0,0.25);
  }

  .fortune p {
    margin: 0;
    white-space: nowrap;
    font-size: 18px;
  }
</style>
</head>
<body>

<div class="scene">
  <div class="hint">Drag the fortune out üç™</div>

  <div class="fortune-wrapper">
    <div class="fortune" id="fortune">
      <p>Something you‚Äôve been waiting for is already on its way.</p>
    </div>
  </div>

  <div class="cookie" id="cookie">
    <div class="cookie-half cookie-left"></div>
    <div class="cookie-half cookie-right"></div>
  </div>
</div>

<script>
  const fortune = document.getElementById("fortune");
  const cookie = document.getElementById("cookie");

  let isDragging = false;
  let startX = 0;
  let currentX = -300;
  let cracked = false;

  function startDrag(e) {
    isDragging = true;
    startX = e.type.includes("touch")
      ? e.touches[0].clientX
      : e.clientX;
  }

  function drag(e) {
    if (!isDragging) return;

    const x = e.type.includes("touch")
      ? e.touches[0].clientX
      : e.clientX;

    const delta = x - startX;
    const nextX = Math.min(0, -300 + delta);

    fortune.style.transform = `translateX(${nextX}px)`;
    currentX = nextX;
  }

  function endDrag() {
    isDragging = false;

    if (currentX > -120) {
      fortune.style.transform = "translateX(0px)";
      currentX = 0;

      if (!cracked) {
        cookie.classList.add("cracked");
        cracked = true;
      }
    }
  }

  fortune.addEventListener("mousedown", startDrag);
  window.addEventListener("mousemove", drag);
  window.addEventListener("mouseup", endDrag);

  fortune.addEventListener("touchstart", startDrag);
  window.addEventListener("touchmove", drag);
  window.addEventListener("touchend", endDrag);
</script>

</body>
</html>
